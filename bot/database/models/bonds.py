from sqlalchemy import Column, Integer, String, ForeignKey, Numeric, Date, BigInteger, Time, CHAR
from sqlalchemy.orm import relationship

from bot.config import Base


class Bond(Base):
    """Модель облигации"""
    __tablename__ = "bonds"

    id = Column(Integer, primary_key=True, index=True)
    user_id = Column(Integer, ForeignKey("users.telegram_id"), nullable=False)

    secid = Column(String(20), nullable=False)
    boardid = Column(String(20), nullable=False)
    shortname = Column(String(255))
    prevwaprice = Column(Numeric(10, 2))
    yieldatprevwaprice = Column(Numeric(5, 2))
    couponvalue = Column(Numeric(5, 2))
    nextcoupon = Column(Date)
    accruedint = Column(Numeric(5, 2))
    prevprice = Column(Numeric(5, 2))
    lotsize = Column(Integer)
    facevalue = Column(Numeric(10, 2))
    boardname = Column(String(255))
    status = Column(CHAR(1))
    matdate = Column(Date)
    decimals = Column(Integer)
    couponperiod = Column(Integer)
    issuesize = Column(Numeric(15, 2))
    prevlegalcloseprice = Column(Numeric(5, 2))
    prevdate = Column(Date)
    secname = Column(String(255))
    remarks = Column(String)  # Используем Text, если есть большие текстовые данные
    marketcode = Column(String(10))
    instrid = Column(String(10))
    sectorid = Column(String(10))
    minstep = Column(Numeric(5, 2))
    faceunit = Column(String(10))
    buybackprice = Column(Numeric(10, 2))
    buybackdate = Column(String(30))
    isin = Column(String(20))
    latname = Column(String(255))
    regnumber = Column(String(50))
    currencyid = Column(String(10))
    issuesizeplaced = Column(Numeric(10, 2))
    listlevel = Column(Integer)
    sectype = Column(CHAR(1))
    couponpercent = Column(Numeric(5, 2))
    offerdate = Column(Date)
    settledate = Column(Date)
    lotvalue = Column(Numeric(10, 2))
    facevalueonsettledate = Column(Numeric(10, 2))
    calloptiondate = Column(Date)
    putoptiondate = Column(Date)
    dateyieldfromissuer = Column(Date)
    bid = Column(Numeric(10, 2))
    biddepth = Column(Numeric(10, 2))
    offer = Column(Numeric(10, 2))
    offerdepth = Column(Numeric(10, 2))
    spread = Column(Numeric(5, 2))
    biddeptht = Column(Numeric(5, 2))
    offerdeptht = Column(Numeric(5, 2))
    open = Column(Numeric(10, 2))
    low = Column(Numeric(10, 2))
    high = Column(Numeric(10, 2))
    last = Column(Numeric(10, 2))
    lastchange = Column(Numeric(5, 2))
    lastchangeprcnt = Column(Numeric(5, 2))
    qty = Column(Numeric(10, 2))
    value = Column(Numeric(10, 2))
    yield_value = Column(Numeric(5, 2))  # Переименовал в yield_value, чтобы избежать конфликта с именем поля
    value_usd = Column(Numeric(10, 2))
    waprice = Column(Numeric(10, 2))
    lastcngtolastwaprice = Column(Numeric(5, 2))
    waptoprevwapriceprcnt = Column(Numeric(5, 2))
    waptoprevwaprice = Column(Numeric(5, 2))
    yieldatwaprice = Column(Numeric(5, 2))
    yieldtoprevyield = Column(Numeric(5, 2))
    closeyield = Column(Numeric(5, 2))
    closeprice = Column(Numeric(10, 2))
    marketpricetoday = Column(Numeric(10, 2))
    marketprice = Column(Numeric(10, 2))
    lasttoprevprice = Column(Numeric(5, 2))
    numtrades = Column(Numeric(10, 2))
    voltoday = Column(Numeric(10, 2))
    valtoday = Column(Numeric(10, 2))
    valtoday_usd = Column(Numeric(10, 2))
    tradingstatus = Column(CHAR(1))
    updatetime = Column(Time)
    duration = Column(Numeric(10, 2))
    numbids = Column(Numeric(10, 2))
    numoffers = Column(Numeric(10, 2))
    change = Column(Numeric(5, 2))
    time = Column(Time)
    highbid = Column(Numeric(10, 2))
    lowoffer = Column(Numeric(10, 2))
    priceminusprevwaprice = Column(Numeric(10, 2))
    lastbid = Column(Numeric(10, 2))
    lastoffer = Column(Numeric(10, 2))
    lcurrentprice = Column(Numeric(10, 2))
    lcloseprice = Column(Numeric(10, 2))
    marketprice2 = Column(Numeric(10, 2))
    openperiodprice = Column(Numeric(10, 2))
    seqnum = Column(BigInteger)
    systime = Column(Time)
    valtoday_rur = Column(Numeric(10, 2))
    iricpiclose = Column(Numeric(10, 2))
    beiclose = Column(Numeric(10, 2))
    cbrclose = Column(Numeric(10, 2))
    yieldtooffer = Column(Numeric(5, 2))
    yieldlastcoupon = Column(Numeric(5, 2))
    tradingsession = Column(String(50))
    calloptionyield = Column(Numeric(5, 2))
    calloptionduration = Column(Numeric(5, 2))

    user = relationship("User", back_populates="bonds")  # Связь с моделью User
